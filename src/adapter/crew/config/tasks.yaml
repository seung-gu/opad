find_news_articles:
  description: >
    Search for 3-5 recent news articles about {topic} in {language}.
    Focus on topic relevance and language — do not filter by length or difficulty at this stage.
    For each article found, use the scraping tool to fetch the FULL article text from its URL.
    Do NOT use search snippets as article content — always scrape the actual page.
    Skip video pages, podcasts, image galleries, and other multimedia-only content — only include articles with substantial text (at least 200 words of body text).
    Return the result as valid JSON format with proper string quotes for all keys and values.
  expected_output: >
    Return a valid JSON object with this exact structure:
    {
      "articles": [
        {
          "title": "Article title",
          "source_name": "Publication name",
          "source_url": "URL or null",
          "publication_date": "Date or null",
          "author": "Author name or null",
          "content": "Full article text"
        }
      ]
    }
    All keys must be in double quotes. All string values must be in double quotes. Use null for optional fields that are not available.
  agent: article_finder
  output_file: output/found_articles.json

pick_best_article:
  description: >
    You MUST select ONLY from the articles provided by the finder. Do NOT search for, invent, or use any article not in the provided list.
    From those articles, rank all candidates by these criteria (in priority order):
    1. Topic: {topic}
    2. Difficulty: {level} level (CEFR) in {language}
    3. Length: approximately {length} words

    Select the ONE article that is the closest overall match.
    Prefer articles focused on a single topic. Avoid roundup/compilation articles that cover multiple unrelated topics (e.g. "good news of the week").
    Only return null if no candidate is even remotely related to the topic. Length and level mismatches are acceptable — the rewriter will adjust those.

    Before selecting, check the source URL to confirm the article exists there.
    If an author name is provided, verify it matches the actual author on the source page. If the author doesn't match or cannot be found on the page, do not include an author name or select a different article.
    Only select articles that can be verified through the source URL.
    If an article cannot be verified, select a different one.
    Return the result as valid JSON format with proper string quotes for all keys and values.
  expected_output: >
    Return a valid JSON object with this exact structure:
    {
      "article": {
        "title": "Article title",
        "source_name": "Publication name",
        "source_url": "URL or null",
        "publication_date": "Date or null",
        "author": "Author name or null",
        "content": "Full article text"
      },
      "selection_rationale": "Explanation of why this article was selected"
    }
    All keys must be in double quotes. All string values must be in double quotes. Use null for optional fields that are not available.
    Only include author if you can verify it exists on the source page.
  agent: article_picker
  context:
    - find_news_articles
  output_file: output/selected_article.json

adapt_news_article:
  description: >
    Take the news article selected by the article picker and rewrite it to match the {level} difficulty level in {language}.
    Adjust the vocabulary to use words appropriate for {level} level learners.
    Simplify sentence structures while maintaining the original meaning and key information.
    Ensure the final text is approximately {length} words.
    Make the content engaging and educational, suitable for language learning reading materials.
    Preserve the main facts, context, and important details from the original article.
    NEVER fabricate or invent information not present in the original article. Only use facts from the provided content.
    If the original article is short, keep the rewrite short — do NOT pad it with made-up content to reach the target length.

    **Vocabulary Reinforcement:**
    The learner has previously studied these words: {vocabulary_list}
    When rewriting the article, prioritize using words from this list where they fit naturally in the context.
    This helps reinforce vocabulary the learner has already encountered.
    Do not force words that don't fit - only use them when contextually appropriate.
    If the vocabulary list is empty, ignore this instruction and proceed normally.

    At the beginning of the output, before the article content, include a source section with:
    - Source name (publication/news outlet name)
    - Source URL as a clickable markdown link
    - Publication date
    - Author name (only if it was verified in the previous step)

    Structure the output with clear markdown sections and headings for better readability.

    IMPORTANT: Do NOT highlight or mark vocabulary words with bold (**), italic (*), backticks (`), or any other formatting. Output plain text only in the article body.
  expected_output: >
    A rewritten version of the selected news article adapted for {level} level learners in {language}.
    The text should be approximately {length} words, use appropriate vocabulary for the level, and maintain all key information from the original article.
    The content should be clear, engaging, and suitable as educational reading material.
    The output must start with a source section containing: source name, source URL (as markdown link), publication date, and author (if available).
    The output must NOT include any vocabulary list, key vocabulary section, or word list at the end.
  agent: article_rewriter
  context:
    - pick_best_article
  output_file: output/adapted_reading_material.md

review_article_quality:
  description: >
    Review the adapted article and fix any issues to produce the final polished version.

    Target language: {language}
    Target level: {level}

    Check and fix:
    1. Grammar errors → correct them
    2. Sentences that don't flow well → improve flow
    3. Vocabulary too difficult for {level} → simplify to match level

    NEVER change direct quotes from people in the original article. Preserve the original wording of quoted speech exactly as written.
    Only fix clear errors — do NOT rephrase stylistic choices made by the original author.

    Preserve all source information (source name, URL, date, author) at the beginning.
    Preserve the original markdown structure and formatting.

    IMPORTANT: Do NOT highlight or mark any words with bold (**), italic (*), backticks (`), or any other formatting. Output plain text only in the article body.

    Return the result as valid JSON format with proper string quotes for all keys and values.
  expected_output: >
    Return a valid JSON object with this exact structure:
    {
      "article_content": "The final polished article in markdown format with source section at the top",
      "replaced_sentences": [
        {
          "original": "Original sentence before change",
          "replaced": "Sentence after the change",
          "rationale": "Reason for the change"
        }
      ]
    }
    All keys must be in double quotes. All string values must be in double quotes.
    If no changes were needed, replaced_sentences should be an empty array [].
  agent: article_reviewer
  context:
    - adapt_news_article
  output_file: output/final_article.json

